module.exports=[88367,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(40695),f=a.i(54161),g=a.i(5522),h=a.i(87682),i=a.i(97895);function j({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{"data-slot":"table",className:(0,i.cn)("w-full caption-bottom text-sm",a),...c})})}function k({className:a,...c}){return(0,b.jsx)("thead",{"data-slot":"table-header",className:(0,i.cn)("[&_tr]:border-b",a),...c})}function l({className:a,...c}){return(0,b.jsx)("tbody",{"data-slot":"table-body",className:(0,i.cn)("[&_tr:last-child]:border-0",a),...c})}function m({className:a,...c}){return(0,b.jsx)("tr",{"data-slot":"table-row",className:(0,i.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...c})}function n({className:a,...c}){return(0,b.jsx)("th",{"data-slot":"table-head",className:(0,i.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}function o({className:a,...c}){return(0,b.jsx)("td",{"data-slot":"table-cell",className:(0,i.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}var p=a.i(65733),q=a.i(96221),r=a.i(70106);let s=(0,r.default)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),t=(0,r.default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);var u=a.i(41710);let v=(0,r.default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var w=a.i(62722);let x=(0,r.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),y=(0,r.default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),z=(0,r.default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),A=(0,r.default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),B=(0,r.default)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),C=(0,r.default)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),D=(0,r.default)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);function E(){let[a,i]=(0,c.useState)([]),[r,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!0),[J,K]=(0,c.useState)("all"),[L,M]=(0,c.useState)("all"),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)("");(0,c.useEffect)(()=>{T()},[]),(0,c.useEffect)(()=>{U()},[a,J,L,R]);let T=async()=>{I(!0);try{let[a,b]=await Promise.all([fetch("/api/admin/orders"),fetch("/api/stock")]),c=await a.json(),d=await b.json();i(c.orders||[]),G(d)}catch(a){console.error("[admin] Error fetching admin data:",a)}finally{I(!1)}},U=()=>{let b=[...a];if("all"!==J&&(b=b.filter(a=>a.estado_pago===J)),"all"!==L&&(b=b.filter(a=>a.estado_envio===L)),""!==R.trim()){let a=R.toLowerCase().trim();b=b.filter(b=>{let c=b.id.toString().includes(a),d=b.cliente?.nombre_apellido?.toLowerCase().includes(a);return c||d})}E(b)},V=async(a,b)=>{try{(await fetch(`/api/admin/orders/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({estado_envio:b})})).ok&&T()}catch(a){console.error("[admin] Error updating order:",a)}},W=a=>new Date(a).toLocaleString("es-AR",{timeZone:"America/Argentina/Buenos_Aires",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});if(H)return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,b.jsx)(q.Loader2,{className:"w-12 h-12 animate-spin text-primary"})});let X=a.filter(a=>"pagado"===a.estado_pago).reduce((a,b)=>a+b.monto_final,0),Y=a.filter(a=>"pendiente"===a.estado_envio&&"pagado"===a.estado_pago).length;return(0,b.jsxs)("div",{className:"min-h-screen bg-background p-6",children:[(0,b.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-black",children:"Panel Administrativo"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Gestión de pedidos Buzzy Twist"})]}),(0,b.jsx)(e.Button,{onClick:T,variant:"outline",children:"Actualizar"})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Stock Disponible"}),(0,b.jsx)(s,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:F?.disponibles||0}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["de ",F?.stock_inicial||900," unidades"]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Unidades Vendidas"}),(0,b.jsx)(t,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:F?.vendidos||0}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[F?Math.round(F.vendidos/F.stock_inicial*100):0,"% del total"]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Ventas Totales"}),(0,b.jsx)(t,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["$",X.toLocaleString("es-AR")]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pagos aprobados"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(d.CardTitle,{className:"text-sm font-medium",children:"Envíos Pendientes"}),(0,b.jsx)(u.Clock,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:Y}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Por despachar"})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(d.CardTitle,{children:"Pedidos"}),(0,b.jsx)(d.CardDescription,{children:"Lista completa de pedidos y su estado"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(g.Input,{type:"text",placeholder:"Buscar por ID o nombre...",value:R,onChange:a=>S(a.target.value),className:"w-64 pr-8"}),(0,b.jsx)(x,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"})]}),R&&(0,b.jsx)(e.Button,{onClick:()=>S(""),variant:"ghost",size:"sm",children:"Limpiar"})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground font-medium",children:"Filtrar por:"}),(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground pl-1",children:"Estado de Pago"}),(0,b.jsxs)(h.Select,{value:J,onValueChange:K,children:[(0,b.jsx)(h.SelectTrigger,{className:"w-[160px]",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"all",children:"Todos los pagos"}),(0,b.jsx)(h.SelectItem,{value:"pagado",children:"Pagado"}),(0,b.jsx)(h.SelectItem,{value:"pendiente",children:"Pendiente"}),(0,b.jsx)(h.SelectItem,{value:"fallido",children:"Fallido"}),(0,b.jsx)(h.SelectItem,{value:"reembolsado",children:"Reembolsado"})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground pl-1",children:"Estado de Envío"}),(0,b.jsxs)(h.Select,{value:L,onValueChange:M,children:[(0,b.jsx)(h.SelectTrigger,{className:"w-[160px]",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"all",children:"Todos los envíos"}),(0,b.jsx)(h.SelectItem,{value:"pendiente",children:"Por enviar"}),(0,b.jsx)(h.SelectItem,{value:"enviado",children:"En camino"}),(0,b.jsx)(h.SelectItem,{value:"entregado",children:"Entregado"})]})]})]})]})]})]})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"rounded-md border overflow-x-auto",children:(0,b.jsxs)(j,{children:[(0,b.jsx)(k,{children:(0,b.jsxs)(m,{children:[(0,b.jsx)(n,{children:"ID Pedido"}),(0,b.jsx)(n,{children:"Fecha y Hora"}),(0,b.jsx)(n,{children:"Cliente"}),(0,b.jsx)(n,{children:"Zona"}),(0,b.jsx)(n,{children:"Monto"}),(0,b.jsx)(n,{children:"Pago"}),(0,b.jsx)(n,{children:"Envío"}),(0,b.jsx)(n,{children:"Acciones"})]})}),(0,b.jsx)(l,{children:0===r.length?(0,b.jsx)(m,{children:(0,b.jsx)(o,{colSpan:8,className:"text-center text-muted-foreground",children:R?"No se encontraron pedidos con esa búsqueda":"No hay pedidos que mostrar"})}):r.map(a=>{var c;let d,g,i;return(0,b.jsxs)(m,{children:[(0,b.jsxs)(o,{className:"font-mono text-xs",children:["#",a.id]}),(0,b.jsx)(o,{className:"text-sm whitespace-nowrap",children:W(a.fecha_creacion)}),(0,b.jsx)(o,{children:(0,b.jsxs)("div",{className:"text-sm",children:[(0,b.jsx)("div",{className:"font-medium",children:a.cliente?.nombre_apellido||"-"}),(0,b.jsx)("div",{className:"text-muted-foreground text-xs",children:a.cliente?.email||"-"})]})}),(0,b.jsx)(o,{children:(0,b.jsx)(f.Badge,{variant:"outline",children:"cba"===a.zona?"Córdoba":"Interior"})}),(0,b.jsxs)(o,{className:"font-semibold",children:["$",a.monto_final.toLocaleString("es-AR")]}),(0,b.jsx)(o,{children:(c=a.estado_pago,i=(g=(d={pagado:{variant:"default",icon:v},pendiente:{variant:"secondary",icon:u.Clock},fallido:{variant:"destructive",icon:w.XCircle},reembolsado:{variant:"outline",icon:w.XCircle}})[c]||d.pendiente).icon,(0,b.jsxs)(f.Badge,{variant:g.variant,className:"gap-1",children:[(0,b.jsx)(i,{className:"w-3 h-3"}),c]}))}),(0,b.jsx)(o,{children:(0,b.jsxs)(h.Select,{value:a.estado_envio,onValueChange:b=>V(a.id,b),disabled:"pagado"!==a.estado_pago,children:[(0,b.jsx)(h.SelectTrigger,{className:"w-[130px]",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"pendiente",children:"Pendiente"}),(0,b.jsx)(h.SelectItem,{value:"enviado",children:"Enviado"}),(0,b.jsx)(h.SelectItem,{value:"entregado",children:"Entregado"})]})]})}),(0,b.jsx)(o,{children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{O(a),Q(!0)},children:"Ver detalles"})})]},a.id)})})]})})})]})]}),(0,b.jsx)(p.Dialog,{open:P,onOpenChange:Q,children:(0,b.jsxs)(p.DialogContent,{className:"max-w-2xl max-h-[85vh] overflow-hidden flex flex-col",children:[(0,b.jsxs)(p.DialogHeader,{children:[(0,b.jsxs)(p.DialogTitle,{children:["Detalles del Pedido #",N?.id]}),(0,b.jsx)(p.DialogDescription,{children:"Información completa del pedido"})]}),N&&(0,b.jsxs)("div",{className:"space-y-6 overflow-y-auto pr-2 -mr-2",style:{overscrollBehavior:"contain"},children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("h3",{className:"font-semibold text-sm flex items-center gap-2",children:[(0,b.jsx)(D,{className:"w-4 h-4"}),"Información del Pedido"]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"ID Pedido"}),(0,b.jsxs)("p",{className:"font-mono",children:["#",N.id]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Número de Serie"}),(0,b.jsx)("p",{className:"font-mono",children:N.unidad?.numero_serie||"Pendiente"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Payment ID"}),(0,b.jsx)("p",{className:"font-mono text-xs break-all",children:N.payment_id||"Pendiente"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Preference ID"}),(0,b.jsx)("p",{className:"font-mono text-xs break-all",children:N.preference_id||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Zona"}),(0,b.jsx)(f.Badge,{variant:"outline",children:"cba"===N.zona?"Córdoba Capital":"Resto del país"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Fecha de Creación"}),(0,b.jsx)("p",{children:W(N.fecha_creacion)})]}),N.fecha_pago&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Fecha de Pago"}),(0,b.jsx)("p",{children:W(N.fecha_pago)})]}),N.fecha_envio&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Fecha de Envío"}),(0,b.jsx)("p",{children:W(N.fecha_envio)})]})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm",children:"Montos"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Monto Original"}),(0,b.jsxs)("p",{className:"font-semibold",children:["$",N.monto_original.toLocaleString("es-AR")]})]}),N.porcentaje_descuento>0&&(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Descuento (",N.porcentaje_descuento,"%)"]}),(0,b.jsxs)("p",{className:"text-green-600 font-semibold",children:["-$",N.monto_descuento.toLocaleString("es-AR")]})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Monto Final"}),(0,b.jsxs)("p",{className:"text-lg font-bold",children:["$",N.monto_final.toLocaleString("es-AR")]})]})]})]}),N.cliente&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("h3",{className:"font-semibold text-sm flex items-center gap-2",children:[(0,b.jsx)(y,{className:"w-4 h-4"}),"Información del Cliente"]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(y,{className:"w-3 h-3"})," Nombre"]}),(0,b.jsx)("p",{className:"font-medium",children:N.cliente.nombre_apellido})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(A,{className:"w-3 h-3"})," Email"]}),(0,b.jsx)("p",{children:N.cliente.email})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(z,{className:"w-3 h-3"})," Teléfono"]}),(0,b.jsx)("p",{children:N.cliente.telefono})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"DNI"}),(0,b.jsx)("p",{children:N.cliente.dni})]}),N.cliente.direccion_completa&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(B,{className:"w-3 h-3"})," Dirección"]}),(0,b.jsx)("p",{children:N.cliente.direccion_completa}),(0,b.jsxs)("p",{className:"text-muted-foreground text-xs mt-1",children:[N.cliente.ciudad,", ",N.cliente.provincia]})]})]})]}),N.comentarios&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("h3",{className:"font-semibold text-sm flex items-center gap-2",children:[(0,b.jsx)(C,{className:"w-4 h-4"}),"Comentarios"]}),(0,b.jsx)("p",{className:"text-sm bg-muted p-3 rounded-md",children:N.comentarios})]})]})]})})]})}a.s(["default",()=>E],88367)}];

//# sourceMappingURL=app_admin_page_tsx_bc658df7._.js.map